<% provide(:title, 'All Drafts') %>
<h1>投稿一覧</h1>

<div class="col-md-10 col-md-offset-1">
  <% if @drafts.empty? %>
    <p>まだ投稿はありません</p>
  <% else %>
    <table class="table table-condensed table-hover" id="table-users">
      <% @drafts.each do |draft| %>
        <tr>
          <td><%= draft.name %>: <%= draft.title %><br>
            <% if current_user.admin? && !current_user?(@user) %>
              <%= link_to "削除", draft, method: :delete, class: "btn btn-md btn-primary",
                  data: { confirm:"削除してよろしいですか？" } %><br>
              <div class="panel-group">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" href="#collapse<%= draft.id %>"><button type="submit" class="btn btn-primary">編集</button></a>
                    </h4>
                  </div>
                  
                  <div id="collapse<%= draft.id %>" class="panel-collapse collapse">
                    <ul class="list-group">
                      <%= form_with model: draft, url: drafts_path, method: :patch, local: true do |d| %>
                        <%= render 'form' %>
                      <% end %>
                    </ul>
                  </div>
                </div>
              </div>
            <% end %>
          </td>
        </tr>
      <% end %>
    </table>
  <% end %> 
</div>
